<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <table border="2">
        <thead>
            <tr>
                <th colspan="6">address</th>
                <th rowspan="3">id</th>
                <th rowspan="3">email</th>
                <th rowspan="3">username</th>
                <th rowspan="3">password</th>
                <th rowspan="1" colspan="2">name</th>
                <th rowspan="3">phone</th>
                <th rowspan="3">__V</th>
                <th rowspan="3">Delete</th>
                <th rowspan="3">Edit</th>
            </tr>
            <tr>
                <th colspan="2">geolocation</th>
                <th rowspan="2">city</th>
                <th rowspan="2">street</th>
                <th rowspan="2">number</th>
                <th rowspan="2">zipcode</th>
                <th rowspan="2">firstname</th>
                <th rowspan="2">lastname</th>
            </tr>
            <tr>
                <th>lat</th>
                <th>long</th>
            </tr>

        </thead>
        <tbody>
        </tbody>
    </table>


    <script src="./users.js"></script>
    <script>
        // console.log(users);
        var allFilteredUsers = [];
        function displayUsers(users) {
            document.querySelector("tbody").innerHTML ="";
            users.forEach((user, i) => {
                var myTr = document.createElement("tr");
                for (a in user) {
                    console.log(a)
                    if (a == "address") {
                        for (b in user[a]) {
                            if (b == "geolocation") {
                                for (c in user[a][b]) {
                                    var myTd = document.createElement("td");
                                    myTd.innerHTML = user[a][b][c];
                                    myTr.appendChild(myTd)
                                }
                            }
                            else {
                                var myTd = document.createElement("td");
                                myTd.innerHTML = user[a][b];
                                myTr.appendChild(myTd)
                            }
                        }
                    }
                    else if (a == "name") {
                        for (d in user[a]) {
                            var myTd = document.createElement("td");
                            myTd.innerHTML = user[a][d];
                            myTr.appendChild(myTd)
                        }
                    }
                    else {
                        var myTd = document.createElement("td");
                        myTd.innerHTML = user[a];
                        myTr.appendChild(myTd);
                    }
                }

                var deleteTd = document.createElement("td");
                var deleteBtn = document.createElement("button");
                deleteBtn.innerHTML = "DELETE";
                deleteBtn.setAttribute("onclick", "deleteUser(" + i + ")");
                deleteTd.appendChild(deleteBtn);
                myTr.appendChild(deleteTd);

                document.querySelector("tbody").appendChild(myTr);
            })
        }

        function deleteUser(i) {
            if (allFilteredUsers.length == 0) {
                allFilteredUsers = users.filter((userFilter, index) => {
                    return index !== i;
                });
            } else {
                allFilteredUsers = allFilteredUsers.filter((userFilter, index) => {
                    return index !== i;
                });
            }

            displayUsers(allFilteredUsers);
        }


        displayUsers(users);
    </script>
</body>

</html>